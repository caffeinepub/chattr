{
  "kind": "build_request",
  "title": "Incremental anonymization: remove accessControlState from backend/main.mo",
  "projectName": "Caffeine Chats",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-10",
      "text": "In backend/main.mo, remove the `accessControlState` variable (`let accessControlState = AccessControl.initState();`) and update all references so the canister still compiles and all existing public functions and signatures remain unchanged.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-3",
          "msg-12"
        ],
        "quotes": [
          "remove the `accessControlState` variable from `backend/main.mo` and adjust any references to it.",
          "Build"
        ]
      },
      "acceptanceCriteria": [
        "`backend/main.mo` no longer defines `accessControlState`.",
        "All prior `AccessControl.*(accessControlState, ...)` call sites compile by passing a valid `AccessControl.AccessControlState` value without reintroducing any new state variable named `accessControlState`.",
        "No public functions are removed, renamed, or have their signatures changed.",
        "The canister builds successfully after the change."
      ]
    }
  ],
  "constraints": [
    "Backend must remain anonymous: do not add any new authorization, caller/principal checks, or permission gates while updating references.",
    "Keep the existing in-file `module AccessControl { ... }` stub (or equivalent) compiling; do not introduce imports of authorization modules.",
    "Limit changes to the smallest stable incremental chunk needed to avoid patch/diff application failures."
  ],
  "nonGoals": [
    "Do not refactor or remove existing public methods beyond updating references needed to remove `accessControlState`.",
    "Do not change frontend code as part of this step.",
    "Do not address the getChatrooms payload-size limit or thumbnail regression in this build unless explicitly requested in a separate step."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  },
  "userProfileUpdate": {
    "goalsToAdd": [],
    "goalsToRemove": [],
    "preferencesToAdd": [],
    "preferencesToRemove": [],
    "miscToAdd": [],
    "miscToRemove": [],
    "fieldsToSet": {},
    "fieldsToDelete": []
  }
}