{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 3,
  "summary": "Investigating and planning a fix for a production bug where the lobby/rooms list does not display on initial load due to a persisted TanStack/React Query cache entry (['chatrooms']=[]) being hydrated before fetch.",
  "architectural_notes": [
    "Production uses persisted TanStack/React Query cache (localStorage/IndexedDB) that hydrates before component mount; stale persisted data for ['chatrooms'] can override initial lobby state."
  ],
  "known_issues": [
    "Live site does not display rooms on initial load unless searched or a category is selected; suspected cause is hydrated persisted React Query cache containing ['chatrooms'] = [] in production."
  ],
  "isFixRequest": true,
  "existing_features": [
    {
      "id": "feature-ensure-the-lobby-shows-rooms-on-initial-load-in-production-even-when-react-query-hydrates-a-persisted-cached-empty-array-for-the-canonical-query-key-chatrooms-by-purging-ignoring-that-hydrated-empty-result-and-forcing-a-fresh-refetch-before-rendering-an-empty-state",
      "title": "Ensure the lobby shows rooms on initial load in production even when React Query hydrates a persisted cached empty array for the canonical query key ['chatrooms'] by purging/ignoring that hydrated empty result and forcing a fresh refetch before rendering an empty-state.",
      "reqIds": [
        "REQ-1"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-1",
      "summary": "Purge or ignore persisted React Query cache for the ['chatrooms'] query on app startup (main.tsx) so rooms display on initial load in production.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-3",
      "summary": "Provide the exact code change (diff-style or full file content) that will be applied to implement the persisted-cache purge/ignore behavior, so the user can review what it looks like before deployment.",
      "reqIds": [
        "REQ-2"
      ],
      "status": "pending"
    }
  ],
  "projectName": "Caffeine Chats",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}